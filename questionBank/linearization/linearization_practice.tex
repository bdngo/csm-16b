% Author: Naomi Sagan
% Emails: naomi.sagan@berkeley.edu

\qns{Linearization Practice}

\meta{
Make sure to draw out what the linearization looks like to help provide intuition.
}

Remember that we linearize nonlinear systems using a first-order Taylor approximation.
\begin{align}
f(x) \approx f(x^{*}) + f'(x^{*})(x - x^{*})
\end{align}
We linearize the function around $x^{*}$, also known as the \textbf{operating point} of the approximation.
We typically choose the operating point such that $f(x^{*}) = 0$, so that the Taylor approximation is
\begin{align}
f(x) \approx f'(x^{*})(x - x^{*})
\end{align}

\begin{enumerate}
    \qitem Consider $f(x) = \cos(x)$
    \begin{enumerate}[label = (\roman*)]
        \item Find all operating points such that $f(x^{*}) = 0$. \\
        \ws{
        \vspace{100px}
        }
        \sol {
            We know that the cosine function is 0 at odd multiples of $\pi/2$ (i.e. $\dots, -\pi/2, \pi/2, 3\pi/2, \dots$). So,
            \begin{align*}
                x^{*} = (2k + 1) \frac{\pi}{2}
            \end{align*}
            where k is any integer.
        }

        \item Choosing one of those operation points, find $f'(x^{*})$. \\
        \ws{
        \vspace{100px}
        }
        \sol {
            For our solution, we're choosing $x^{*} = \pi/2$, but you can use any valid operating point.
            \begin{align*}
                f'(x) = \frac{d}{dx} \cos(x) = -\sin(x) \\
                f'(x^{*}) = f'(\pi/2) = -\sin(\pi/2) = -1
            \end{align*}
        }

        \item Linearize the function around the same operating point you used for part (ii). \\
        \ws{
        \vspace{100px}
        }
        \sol {
            Again, we're using $x^{*} = \pi/2$ as our operating point. We chose the operating point such that $f(x^{*}) = 0$, so we can approximate $f$ as follows:
            \begin{align*}
                f(x) \approx f'(x^{*})(x - x^{*}) \\
                f(x) \approx -(x - \pi/2)
            \end{align*}
        }
    \end{enumerate}

    \qitem Repeat the same process for $f(x) = e^x - 1$
    \begin{enumerate}[label = (\roman*)]
        \item Find all operating points such that $f(x^{*}) = 0$. \\
        \ws{
        \vspace{100px}
        }
        \sol {
           To find the operating point, we set $e^{x^{*}} - 1$ equal to 0, which is the same as setting $e^{x^{*}}$ equal to 1.
           $e^x$ is 1 only when $x = 0$, so we can define our operating point as $x^{*} = 0$.
        }

        \item Choosing one of those operation points, find $f'(x^{*})$. \\
        \ws{
        \vspace{100px}
        }
        \sol {
            Plugging $x^{*} = 0$ into the first derivative of f, we get:
            \begin{align*}
                f'(x) = \frac{d}{dx} (e^x - 1) = e^x \\
                f'(x^{*}) = f'(0) = e^0 = 1
            \end{align*}
        }

        \item Linearize the function around the same operating point you used for part (ii). \\
        \ws{
        \vspace{100px}
        }
        \sol {
            As before, we can approximate $f$ as follows:
            \begin{align*}
                f(x) \approx f'(x^{*})(x - x^{*}) \\
                f(x) \approx (x - 0) = x
            \end{align*}
        }
    \end{enumerate}

    \qitem (OPTIONAL) Repeat the same process for $f(x) = x - x^2$
    \begin{enumerate}[label = (\roman*)]
        \item Find all operating points such that $f(x^{*}) = 0$. \\
        \ws{
        \vspace{100px}
        }
        \sol {
           To find the operating point, we set $x^{*} - (x^{*})^2$ to 0:
           \begin{align*}
                x^{*} - (x^{*})^2 = x^{*}(1 - x^{*}) = 0 \\
                x^{*} = 0, 1
           \end{align*}
        }

        \item Choosing one of those operation points, find $f'(x^{*})$. \\
        \ws{
        \vspace{100px}
        }
        \sol {
            We will choose to linearize around $x^{*} = 0$:
            \begin{align*}
                f'(x) = \frac{d}{dx} (x - x^2) = 1 - 2x \\
                f'(x^{*}) = f'(0) = 1 - 0 = 1
            \end{align*}
        }

        \item Linearize the function around the same operating point you used for part (ii). \\
        \ws{
        \vspace{100px}
        }
        \sol {
            As before, we can approximate $f$ as follows (using $x^{*} = 0$, as in part (ii)):
            \begin{align*}
                f(x) \approx f'(x^{*})(x - x^{*}) \\
                f(x) \approx (x - 0) = x
            \end{align*}
        }
    \end{enumerate}
\end{enumerate}
